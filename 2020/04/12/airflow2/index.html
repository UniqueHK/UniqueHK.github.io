<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>【译】Airflow的挑战者Prefect | 宽视角</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="airflow是一个python的DAG任务管理工具，来自airb&amp;b，适合跨平台部署，调度器是相对静态批处理的。Prefect解决了诸多新时代应用场景问题，成为airflow的有力挑战者。">
<meta name="keywords" content="off-schedule,concurrently,complicated,flexible,parametrized,dynamic">
<meta property="og:type" content="article">
<meta property="og:title" content="【译】Airflow的挑战者Prefect">
<meta property="og:url" content="http://yoursite.com/2020/04/12/airflow2/index.html">
<meta property="og:site_name" content="宽视角">
<meta property="og:description" content="airflow是一个python的DAG任务管理工具，来自airb&amp;b，适合跨平台部署，调度器是相对静态批处理的。Prefect解决了诸多新时代应用场景问题，成为airflow的有力挑战者。">
<meta property="og:locale" content="default">
<meta property="og:image" content="http://yoursite.com/2020/04/12/airflow2/airflow.png">
<meta property="og:updated_time" content="2020-04-14T08:51:33.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="【译】Airflow的挑战者Prefect">
<meta name="twitter:description" content="airflow是一个python的DAG任务管理工具，来自airb&amp;b，适合跨平台部署，调度器是相对静态批处理的。Prefect解决了诸多新时代应用场景问题，成为airflow的有力挑战者。">
<meta name="twitter:image" content="http://yoursite.com/2020/04/12/airflow2/airflow.png">
  
    <link rel="alternative" href="/atom.xml" title="宽视角" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css">
</head>
</html>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	
		<form class="search" action="/search/index.html" method="get" accept-charset="utf-8">
			<label>Search</label>
			<input type="text" id="st-search-input" class="st-default-search-input st-search-input_my" maxlength="30" placeholder="Search" />
		</form>
	
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="https://avatars1.githubusercontent.com/u/4168558?v=3&amp;s=460" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">宽视角</a></h1>
		</hgroup>

		
        <h3 style="font-weight:bold;font-style:italic;" class="header-subtitle">listen</h3>
        

		
		<p class="header-subtitle">年轻是什么？就是越挫越勇！</p>
		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>Menu</li>
						<li>Tags</li>
						
						<li>Links</li>
						
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/listen-lavender" title="github">github</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/" style="font-size: 10px;">==</a> <a href="/tags/DAG/" style="font-size: 10px;">DAG</a> <a href="/tags/FP/" style="font-size: 10px;">FP</a> <a href="/tags/LRU-cache/" style="font-size: 10px;">LRU cache</a> <a href="/tags/Newton-iteration/" style="font-size: 10px;">Newton iteration</a> <a href="/tags/OOP/" style="font-size: 10px;">OOP</a> <a href="/tags/Slice分布式/" style="font-size: 10px;">Slice分布式</a> <a href="/tags/Time-Quantum/" style="font-size: 10px;">Time Quantum</a> <a href="/tags/async-task/" style="font-size: 10px;">async task</a> <a href="/tags/asynchronous/" style="font-size: 10px;">asynchronous</a> <a href="/tags/asyncio/" style="font-size: 10px;">asyncio</a> <a href="/tags/authority/" style="font-size: 10px;">authority</a> <a href="/tags/background/" style="font-size: 10px;">background</a> <a href="/tags/beanstalkd/" style="font-size: 10px;">beanstalkd</a> <a href="/tags/binary-search/" style="font-size: 10px;">binary search</a> <a href="/tags/bit/" style="font-size: 10px;">bit</a> <a href="/tags/bitmap/" style="font-size: 20px;">bitmap</a> <a href="/tags/brpop/" style="font-size: 10px;">brpop</a> <a href="/tags/cache-algorithm/" style="font-size: 10px;">cache algorithm</a> <a href="/tags/cell/" style="font-size: 10px;">cell</a> <a href="/tags/column/" style="font-size: 10px;">column</a> <a href="/tags/comet-streaming/" style="font-size: 10px;">comet streaming</a> <a href="/tags/complicated/" style="font-size: 10px;">complicated</a> <a href="/tags/concurrently/" style="font-size: 10px;">concurrently</a> <a href="/tags/context/" style="font-size: 10px;">context</a> <a href="/tags/coroutine/" style="font-size: 10px;">coroutine</a> <a href="/tags/csrf/" style="font-size: 10px;">csrf</a> <a href="/tags/data-pipeline/" style="font-size: 10px;">data pipeline</a> <a href="/tags/datamodel/" style="font-size: 10px;">datamodel</a> <a href="/tags/distributed/" style="font-size: 10px;">distributed</a> <a href="/tags/dynamic/" style="font-size: 10px;">dynamic</a> <a href="/tags/extract/" style="font-size: 10px;">extract</a> <a href="/tags/flexible/" style="font-size: 10px;">flexible</a> <a href="/tags/frame/" style="font-size: 10px;">frame</a> <a href="/tags/gen-coroutine/" style="font-size: 10px;">gen.coroutine</a> <a href="/tags/goroutine/" style="font-size: 10px;">goroutine</a> <a href="/tags/greenlet/" style="font-size: 10px;">greenlet</a> <a href="/tags/gunicorn/" style="font-size: 10px;">gunicorn</a> <a href="/tags/hashtable/" style="font-size: 10px;">hashtable</a> <a href="/tags/hash优化/" style="font-size: 10px;">hash优化</a> <a href="/tags/hash制度/" style="font-size: 10px;">hash制度</a> <a href="/tags/header/" style="font-size: 10px;">header</a> <a href="/tags/http1-0/" style="font-size: 10px;">http1.0</a> <a href="/tags/http1-1/" style="font-size: 10px;">http1.1</a> <a href="/tags/http2-0/" style="font-size: 10px;">http2.0</a> <a href="/tags/include/" style="font-size: 10px;">include</a> <a href="/tags/index/" style="font-size: 20px;">index</a> <a href="/tags/interface/" style="font-size: 10px;">interface</a> <a href="/tags/ioloop/" style="font-size: 10px;">ioloop</a> <a href="/tags/is/" style="font-size: 10px;">is</a> <a href="/tags/json/" style="font-size: 10px;">json</a> <a href="/tags/judge/" style="font-size: 10px;">judge</a> <a href="/tags/keyexpired/" style="font-size: 10px;">keyexpired</a> <a href="/tags/learning/" style="font-size: 10px;">learning</a> <a href="/tags/level/" style="font-size: 20px;">level</a> <a href="/tags/linux/" style="font-size: 10px;">linux</a> <a href="/tags/long-polling/" style="font-size: 10px;">long polling</a> <a href="/tags/lpush/" style="font-size: 10px;">lpush</a> <a href="/tags/lxml/" style="font-size: 10px;">lxml</a> <a href="/tags/mergelist/" style="font-size: 10px;">mergelist</a> <a href="/tags/method/" style="font-size: 10px;">method</a> <a href="/tags/mongo/" style="font-size: 10px;">mongo</a> <a href="/tags/mongo-id/" style="font-size: 10px;">mongo_id</a> <a href="/tags/monitor/" style="font-size: 10px;">monitor</a> <a href="/tags/mq通信/" style="font-size: 10px;">mq通信</a> <a href="/tags/multi-process/" style="font-size: 10px;">multi process</a> <a href="/tags/nosql/" style="font-size: 10px;">nosql</a> <a href="/tags/object-oriented/" style="font-size: 10px;">object-oriented</a> <a href="/tags/off-schedule/" style="font-size: 10px;">off-schedule</a> <a href="/tags/package/" style="font-size: 10px;">package</a> <a href="/tags/parallel/" style="font-size: 10px;">parallel</a> <a href="/tags/parametrized/" style="font-size: 10px;">parametrized</a> <a href="/tags/performance/" style="font-size: 10px;">performance</a> <a href="/tags/phantomjs/" style="font-size: 10px;">phantomjs</a> <a href="/tags/pointer/" style="font-size: 10px;">pointer</a> <a href="/tags/pointerarray/" style="font-size: 10px;">pointerarray</a> <a href="/tags/powerful/" style="font-size: 10px;">powerful</a> <a href="/tags/priority/" style="font-size: 20px;">priority</a> <a href="/tags/procedure-oriented/" style="font-size: 10px;">procedure-oriented</a> <a href="/tags/property/" style="font-size: 10px;">property</a> <a href="/tags/python/" style="font-size: 10px;">python</a> <a href="/tags/queue/" style="font-size: 10px;">queue</a> <a href="/tags/recursive-struct/" style="font-size: 10px;">recursive struct</a> <a href="/tags/redis/" style="font-size: 10px;">redis</a> <a href="/tags/regex/" style="font-size: 10px;">regex</a> <a href="/tags/requests/" style="font-size: 10px;">requests</a> <a href="/tags/row/" style="font-size: 10px;">row</a> <a href="/tags/rpc通信/" style="font-size: 10px;">rpc通信</a> <a href="/tags/rwx/" style="font-size: 10px;">rwx</a> <a href="/tags/setter-getter/" style="font-size: 10px;">setter/getter</a> <a href="/tags/shell-script/" style="font-size: 10px;">shell script</a> <a href="/tags/signatures/" style="font-size: 10px;">signatures</a> <a href="/tags/specific-type/" style="font-size: 10px;">specific type</a> <a href="/tags/sqrt/" style="font-size: 10px;">sqrt</a> <a href="/tags/task-flow/" style="font-size: 10px;">task flow</a> <a href="/tags/threading/" style="font-size: 10px;">threading</a> <a href="/tags/type-assert/" style="font-size: 10px;">type assert</a> <a href="/tags/urlparameter/" style="font-size: 10px;">urlparameter</a> <a href="/tags/websocket/" style="font-size: 10px;">websocket</a> <a href="/tags/weight/" style="font-size: 10px;">weight</a> <a href="/tags/worthy/" style="font-size: 10px;">worthy</a> <a href="/tags/上/" style="font-size: 10px;">上</a> <a href="/tags/两小无猜/" style="font-size: 10px;">两小无猜</a> <a href="/tags/乌托邦/" style="font-size: 10px;">乌托邦</a> <a href="/tags/人生半坡/" style="font-size: 10px;">人生半坡</a> <a href="/tags/优先级/" style="font-size: 10px;">优先级</a> <a href="/tags/使用场景/" style="font-size: 10px;">使用场景</a> <a href="/tags/先验概率/" style="font-size: 10px;">先验概率</a> <a href="/tags/全概率/" style="font-size: 10px;">全概率</a> <a href="/tags/冲突/" style="font-size: 10px;">冲突</a> <a href="/tags/减法/" style="font-size: 10px;">减法</a> <a href="/tags/分布式/" style="font-size: 10px;">分布式</a> <a href="/tags/分支限界/" style="font-size: 10px;">分支限界</a> <a href="/tags/分治/" style="font-size: 10px;">分治</a> <a href="/tags/分类/" style="font-size: 10px;">分类</a> <a href="/tags/动态规划/" style="font-size: 10px;">动态规划</a> <a href="/tags/努力/" style="font-size: 10px;">努力</a> <a href="/tags/匿名变量/" style="font-size: 10px;">匿名变量</a> <a href="/tags/单线程/" style="font-size: 10px;">单线程</a> <a href="/tags/后验概率/" style="font-size: 10px;">后验概率</a> <a href="/tags/周星驰/" style="font-size: 10px;">周星驰</a> <a href="/tags/哈希/" style="font-size: 10px;">哈希</a> <a href="/tags/回溯/" style="font-size: 10px;">回溯</a> <a href="/tags/多线程/" style="font-size: 10px;">多线程</a> <a href="/tags/富类hash/" style="font-size: 10px;">富类hash</a> <a href="/tags/小巧/" style="font-size: 10px;">小巧</a> <a href="/tags/嵌入式脚本/" style="font-size: 10px;">嵌入式脚本</a> <a href="/tags/异步IO/" style="font-size: 10px;">异步IO</a> <a href="/tags/张小凡/" style="font-size: 10px;">张小凡</a> <a href="/tags/性能/" style="font-size: 10px;">性能</a> <a href="/tags/排序/" style="font-size: 10px;">排序</a> <a href="/tags/新年快乐/" style="font-size: 10px;">新年快乐</a> <a href="/tags/条件查询/" style="font-size: 10px;">条件查询</a> <a href="/tags/条件概率/" style="font-size: 10px;">条件概率</a> <a href="/tags/浮夸/" style="font-size: 10px;">浮夸</a> <a href="/tags/混沌hash/" style="font-size: 10px;">混沌hash</a> <a href="/tags/热加载/" style="font-size: 10px;">热加载</a> <a href="/tags/父类方法调用子类方法/" style="font-size: 10px;">父类方法调用子类方法</a> <a href="/tags/状态/" style="font-size: 10px;">状态</a> <a href="/tags/田灵儿/" style="font-size: 10px;">田灵儿</a> <a href="/tags/自省自乐/" style="font-size: 10px;">自省自乐</a> <a href="/tags/自虐/" style="font-size: 10px;">自虐</a> <a href="/tags/贪心/" style="font-size: 10px;">贪心</a> <a href="/tags/转码/" style="font-size: 10px;">转码</a> <a href="/tags/阻塞完成/" style="font-size: 10px;">阻塞完成</a> <a href="/tags/随心随性/" style="font-size: 10px;">随心随性</a>
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://braavos.me/">落在深海</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://sanyuesha.com/">三月沙</a>
			        
			        </div>
				</section>
				

				
			</div>
		</div>
	</header>				
</div>

    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">listen</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
			
				<img lazy-src="https://avatars1.githubusercontent.com/u/4168558?v=3&amp;s=460" class="js-avatar">
			
			</div>
			<hgroup>
			  <h1 class="header-author">listen</h1>
			</hgroup>
			
			<p class="header-subtitle">年轻是什么？就是越挫越勇！</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/listen-lavender" title="github">github</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>

      <div class="body-wrap"><article id="post-airflow2" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2020/04/12/airflow2/" class="article-date">
  	<time datetime="2020-04-12T02:35:13.000Z" itemprop="datePublished">2020-04-12</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      【译】Airflow的挑战者Prefect
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/complicated/">complicated</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/concurrently/">concurrently</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/dynamic/">dynamic</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/flexible/">flexible</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/off-schedule/">off-schedule</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/parametrized/">parametrized</a></li></ul>
	</div>

        
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/backend-tool/">backend-tool</a>
	</div>


        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><img src="/2020/04/12/airflow2/airflow.png" alt="airflow"></p>
<p>在数据工程生态系统，Airflow一直是一个重要的工具，技术工作者也利用它开发了很多业务。它开创性地兼备严格DAG模型和Python的灵活性，从而广泛的适用现实生活中的工作流业务。然而，airflow被当做一个臃肿的批处理调度器来设计，目标使用者是团队原则上招来协调组织其他系统的数据工程师，因此其可用性受到了很大限制。</p>
<p>今天，许多数据工程师正在与分析人员更直接地合作。计算存储都是便宜的，使得试错成本低，注重实验。业务工作流快速动态变化。Airflow在许多事情上做对了，但是其核心假设从未预料到数据应用会变得如此多样化。很显然，它没有需要的语法接口来实现那些新的业务活动。</p>
<p>时间追溯到2016年Airflow如何改变来支撑新的多样化数据实践的讨论中，Prefect的第一次全面计划就此埋下种子。令人失望的是，Aiflow并未改进。我们开源了现代化的数据平台Prefect，早期的commit和评论反馈令我们很鼓舞。</p>
<p>我们知道用户关心关于Prefect与Airflow对比，尤其是考虑到Prefect的血统与Airflow相关。本文就是要强调Prefect引擎是如何用特定步骤解决一些Airflow无法解决的问题，并不是详尽的Prefect特性说明书，而是提供给熟悉Airflow的用户指南，解释Prefect解决问题的类似方法。我们希望对社区有用，尽可能地讨论解决了的问题和方法，对于开源仓库中当前不可用内容试图保持平衡和克制。</p>
<p>内容提要</p>
<ul>
<li>概览</li>
<li>API</li>
<li>调度和时间的关系</li>
<li>调度服务</li>
<li>数据流</li>
<li>参数化工作流</li>
<li>动态工作流</li>
<li>多版本工作流</li>
<li>本地测试</li>
<li>UI操作界面</li>
<li>总结</li>
</ul>
<h2 id="概览"><a href="#概览" class="headerlink" title="概览"></a>概览</h2><p>Airflow是为了按照固定的时间调度运行偏静态的、流转缓慢的工作流而设计，Airflow是达到了这个目的的优秀工具。Airflow也是第一个成功实现工作流即代码、灵活有用的范例。事实证明，无需借助配置文件，不使用DAG定义，也可实现工作流。</p>
<p>然而，从为了能处理的工作流类型来看，Airflow为设计工作流行为提供的语法接口很有限，尤其以现在的标准来看。用户为了实现业务，把业务强制地塞进Airflow模型会遇到麻烦。例如Airflow不能很好地满足以下场景：</p>
<ul>
<li>无调度或者脱离调度的DAG</li>
<li>同一时间多次并发启动的DAG</li>
<li>复杂分支逻辑的DAG</li>
<li>实时任务DAG</li>
<li>需要交换数据的DAG</li>
<li>参数化的DAG</li>
<li>动态的DAG</li>
</ul>
<p>如果你的使用场景与上述任何一种相似，无法直接使用Airflow，你需要在Airflow的抽象设计层面花费大量的工夫。因此，几乎每个中大规模的公司最终都会编写自定义的DSL，或者维护大量专有插件来满足内部多变的业务需求。这使得故障维护和升级困难。</p>
<p>Prefect是多年从事Airflow相关项目的经验成果。我们的研究覆盖了数百用户和公司，让我们发现了Airflow难以解决的隐患。通过设计支撑适合大多数业务场景的架构抽象，它最终实现了难以置信的友好和轻量的接口。</p>
<h2 id="API"><a href="#API" class="headerlink" title="API"></a>API</h2><blockquote>
<p>  当工作流能够定义成代码时，他们变得更加<br>  易于维护，方便多版本追踪，好测试，可协作。</p>
<p>  – Airflow 官方文档</p>
</blockquote>
<p>生产工作流程是对复杂业务非常有益的事物，并且涉及技术范围内多个利益者。因此，让你工作流足够简单明了是很重要的。考虑到工作流在数据处理技术栈处处可用。Python是工作流语言的最优选择。Airflow是第一个认识到这一点的工具，并且用Python实现API。</p>
<p>但是，Airflow的API是命令式和基于类的。此外，由于Airflow对工作流可以说什么和不能做什么的限制（后面展开讲），编写Airflow DAG代码感觉像是在开发Airflow代码。</p>
<p>Prefect的基本理念是，如果开发者能够保证编写的业务代码按预期正常运行，可以当工作流系统不存在。只有当bug出现，程序抛异常，工作流管理的作用才显现出来。有鉴于此，工作流系统算是流程风险管理工具，并且设计合理的情况下，应该降低工作流系统代码对业务代码的显示侵入，除非开发者明确需要。无论哪种方式，工作流</p>
<p>所以Prefect的设计目标是在业务代码正确的情况下，尽量减少工作流系统代码侵入，同时在业务代码出错时，工作流系统工具代码能尽量帮助重回正轨。无论哪种方式，Prefect都可以为工作流提供相同级别的透明度和细节。</p>
<p>实现上述目标的一种方法是通过Prefect的功能性API。在此模式下，Prefect任务行为类似于函数。你可以添加输入，调用函数，并且使用函数的输出。简单到只用一行Prefect接口代码，就可以将Python函数转换为任务。任务之间的互相调用就像是Python函数一样自然地构建DAG，非常有Python风格。这使得将已有代码和脚本转换成全栈的Prefect工作流是轻车熟路的。</p>
<p>不用担心，Prefect同时还为Airflow用户提供全栈的过程式风格的API。过程式风格API对于复杂任务依赖的工作流是很有用，可以实现底层抽象控制。用户可以根据需求和倾向，来切换这两种风格。</p>
<h2 id="调度和时间的关系"><a href="#调度和时间的关系" class="headerlink" title="调度和时间的关系"></a>调度和时间的关系</h2><blockquote>
<p>  时间是一种幻想。午餐时间加倍。</p>
<p>  – 银河系漫游指南</p>
</blockquote>
<p>对于Airflow的新手来说，可能最常见的困惑是时间的使用。如果你运行Airflow教程例子，你会发现一直要纠结所有这些时间定义是什么意思呢？</p>
<p>Airflow严格依赖execution_date的时间定义。DAG要设置execution_date才可以运行，同一个execution_date的同一个DAG也不可能运行2次。你有没有一个DAG需要同时开始执行两次的呢？Airflow无法支持。你需要创建两个除了DAG ID之外完全相同的DAG，或者相隔1ms启动，或者使用有创造性的Hack方式使它起作用。</p>
<p>更令人困惑的是，execution_date并不是Airflow DAG的start_time，start_time=execution_date+一个周期间隔。这最初是由于ELT编排要求所致，execution_date为5月2日时间点的数据作业将在5月3日的同一时间点真正开始运行。时至今日，这都是用户尤其是新用户的最大困惑。</p>
<p>下一个时间点再运行产生的间隔设计起源于Airflow严格要求DAG有良好的执行计划。直到最近，它不可能运行脱离调度的DAG，因为调度器无法给这类DAG安排正确的start_time。临时运行也是可能的，只要这些临时运行的DAG_RUN不与同一个DAG下面的其他DAG_RUN有相同的start_time。</p>
<p>这意味着如果你有以下需求：</p>
<ul>
<li>不规则调度或者无调度的工作流</li>
<li>同一个工作流同时开始的多份运行</li>
<li>维护一个仅仅手工触发运行的工作流</li>
</ul>
<p>那么Airflow会是一个错误的工具。</p>
<blockquote>
<p>作为对比，Prefect将工作流当作可以任何时候执行、任意并发的对象。<br>调度计划只不过是一组预定义好的start_time，可以根据需求很灵活的定义简单或者复杂的调度计划。<br>如果确实需要工作流依赖于时间计划，只需要简单地将时间添加为工作流的参数</p>
</blockquote>
<h2 id="调度服务"><a href="#调度服务" class="headerlink" title="调度服务"></a>调度服务</h2><blockquote>
<p>R2-D2（星球大战的宇航技工机器人），你比起你作为一台奇怪的计算机器了解的更好。</p>
<p>–C-3PO（星球大战的礼仪机器人）</p>
</blockquote>
<p>Airflow的调度器是Airflow的核心骨架，对Airflow有性能影响。主要负责如下：</p>
<ul>
<li>每隔几秒钟重新分析一次DAG文件夹</li>
<li>检查DAG计划以确定DAG是否准备就绪</li>
<li>检查所有任务依赖项，以确定是否有任何任务可以运行</li>
<li>在数据库设置最终的DAG运行状态</li>
</ul>
<p>相反地，Prefect将这许多架构逻辑解耦到不同独立的模块中。</p>
<h3 id="Prefect-Flow-Scheduling"><a href="#Prefect-Flow-Scheduling" class="headerlink" title="Prefect Flow Scheduling"></a>Prefect Flow Scheduling</h3><p>Prefect工作流调度是很轻量的，我们只需要简单地创建一个新的工作流执行，并且设置成Scheduled状态。这就是Prefect的实际的唯一的责任，调度器绝对不会参与任何业务逻辑或者执行。</p>
<h3 id="Prefect-Flow-logic"><a href="#Prefect-Flow-logic" class="headerlink" title="Prefect Flow logic"></a>Prefect Flow logic</h3><p>Prefect流的逻辑是工作流里面的独立单元，调度程序绝不解析业务部分，也不会工作流相关的状态掺杂到业务里面。作为证据，你可以在本地对比运行业务代码添加工作流和未添加工作流的情况，发现添加工作流情况对业务执行几乎没有额外资源开销。</p>
<h3 id="Prefect-Task-scheduling"><a href="#Prefect-Task-scheduling" class="headerlink" title="Prefect Task scheduling"></a>Prefect Task scheduling</h3><p>当Prefect工作流在运行期间，只管调度属于自己的task，这非常重要：</p>
<ul>
<li>从工作流的架构抽象看，流对象是唯一一个适合承载这个责任的</li>
<li>减轻了中枢调度器的负担</li>
<li>针对各种独特场景做决策，例如动态生成任务</li>
<li>将执行细节交给Dask等外部系统负责</li>
</ul>
<p>最后一点很重要，尽管Airflow已经丰富地支持了多种执行环境，包括本地进程执行器、Celery执行器、Dask执行器、Kubernetes执行器，调度器仍然是Airflow工作流的瓶颈，调度器执行任何task都需要额外时间至少10s，5s用来标记已经就绪，5s用来提交执行。不管外部执行系统例如Dask集群有多大，Airflow会每隔10s调用task执行。</p>
<p>相比而言，Prefect采用了更现代化的方式。例如当Prefect在Dask上面执行的时候，我们利用Dask的毫秒级延迟任务调度器来尽快运行所有task，并且能充分利用Dask集群的并行度。实际上Prefect Cloud的默认部署规范是在Kubernetes中使用Dask集群，这也是可定制化的。</p>
<p>除性能外，这对于工作流的设计很有意义。Airflow鼓励设计庞大的task，Prefect倾向设计微型的模块化task，也保留了处理大型task的能力。</p>
<p>另外，当使用Prefect Clound运行带数据连接的task时，Task和工作流的执行者负责维护数据库连接的状态，而不是由调度器维护。</p>
<p>总结</p>
<ul>
<li><p>中心化的Airflow调度循环使得当任务启动遇到任务依赖处理时，会产生不小的延迟。如果使用场景只涉及到少数几个长时间运行的task，这完全没问题，但是如果你想执行一个包含有时间要求的大量task的DAG，这可能成为瓶颈。</p>
</li>
<li><p>Airflow将时间计划和工作流紧密耦合一起，这意味着你即使在本地运行DAG，也需要初始化数据库和调度服务。这当然是生产环境必要的步骤，但是对于业务代码的快速迭代和测试是很麻烦的。</p>
</li>
<li><p>Airflow调度器的集中特性形成了系统的单点故障。</p>
</li>
<li><p>循环重新解析DAG会造成严重的不一致，很有可能调度器将要执行的task，发现对应的DAG不存在。</p>
</li>
<li><p>集中调度意味着多个task之间无法通信（没有通信依赖关系解决方案）。</p>
</li>
</ul>
<h2 id="数据流"><a href="#数据流" class="headerlink" title="数据流"></a>数据流</h2><blockquote>
<p>  它是一个陷阱。</p>
<p>  – 《星球大战》贾尔·阿克巴上将</p>
</blockquote>
<p>Airflow最常见的用途之一建立某种数据管道，但是讽刺的是，Airflow并没有支持最好的方式实现它。</p>
<p>Airflow提供XCom，一个被设计用来task之间交换少量数据的工具。如果你希望task A告诉task B大量的数据写到云端的某个可见的位置，这是有用的。但是，当用户视图使用它建立数据管道，它成为Airflow的使用bug的主来源。</p>
<p>XCom使用管理员权限将可执行的序列化数据写到元数据的数据库，这有安全隐患。即使采用json格式，也还是有隐私问题。这个数据没有过期时间或者有效期限制，会造成性能和存储成本问题。更重要的是，使用XComs会在Airflow调度器不知情的情况，在task之间创建严格的上下游关系依赖。如果用户再不增加额外的人工关注，Airflow实际可能会用错误的顺序执行这些任务。考虑一下情况：</p>
<p>Airflow工具是无法确定某个任务明确依赖于另一个推类型任务的行为。如果用户没有明确向Airflow说明，调度器还是会无序运行这些任务。即使用户跟Airflow说明关系，Airflow也无法理解基于通信数据的依赖关系，而且当XCom推送失败，Airflow也不知道怎么响应。这是最常见的玄奥难解的Airflow bug之一。</p>
<p>不幸的是，经常有这种情况，Airflow新手过度使用XCom堵死了元数据库，我们看到过有人创建了10GB规模的数据，并用XCom传递给各种任务。DAG要是有10个task，一共会写100GB的数据到Airflow的元数据数据库。</p>
<p>Prefect将数据流设计为一等公民。task可以输入返回，Prefect用透明方式管理这些输入输出依赖。另外，Prefect永远不会将这些数据写入元数据数据库，相反的，阶段task在需要结果存储的时候，可以轻松配置安全的结果处理程序来管理。这样提供了许多好处：</p>
<ul>
<li>用户可以使用熟悉的Python风格编码</li>
<li>引擎知道依赖关系，这提供了更加透明的调试体验</li>
<li>因为Prefect允许使用数据流，并不意味着只能用它，所以仍然支持无依赖的Airflow风格，有时候鼓励使用它。</li>
<li>因为task可以交换数据，Prefect能支持更复杂的分支逻辑、丰富的task状态，并且在flow中task和runner之间执行更严格的约定</li>
</ul>
<h2 id="参数化工作流"><a href="#参数化工作流" class="headerlink" title="参数化工作流"></a>参数化工作流</h2><blockquote>
<p>  很抱歉Dave，恐怕我做不到。</p>
<p>  – 《2001太空漫游》超级电脑HAL9000</p>
</blockquote>
<p>有能力处理响应不同的输入是很方便的。例如，一个工作流可能就是一系列的步骤，可以重复处理不同API、数据库或者ID的信息，这些不同的数据需要复用相同的处理逻辑。甚至，你可能想用输入参数来影响工作流本身。</p>
<p>因为Airflow DAG要按固定的调度计划来执行，并且不接收输入调用参数，这不是Airflow能很好支持的模式。当然也可以解决这个限制，但是解决方案涉及到改造Airflow调度器持续重复解析DAG文件和动态响应DAG变量。如果你的业务需要利用调度程序的内部细节，你可能做错了。</p>
<p>Prefect为此类情况提供了方便的抽象。Prefect工作流的参数是一种特殊的task，它的值在运行期是可覆盖的。例如，我们在Prefect Cloud部署中运行时，可以通过简单的GraphQL调用或者Prefect的Python客户端来提供参数。</p>
<p>这提供了许多好处：</p>
<ul>
<li>当问题出现，数据的来龙去脉是透明的</li>
<li>你不需要为不同的参数输入创建新的工作流，只需要启动新的工作流执行。</li>
<li>允许设置响应事件的工作流，工作流可以根据不同的类型内容的事件来执行不同的分支</li>
</ul>
<p>早些时候，我们注意到Airflow甚至都没有同时运行一个工作流多个实例的概念。这有部分原因是Airflow工作流没有参数概念。当工作流无法响应输入，同时运行多个实例就没有意义。</p>
<p>但是，有了一等公民的参数化，我们就容易理解为什么我可能希望同时运行工作流的多个实例，例如发送多封电子邮件，或者更新多个数据源，或者任何其他系列活动等工作流逻辑相同和输入值可能不同的场景。</p>
<h2 id="动态化工作流"><a href="#动态化工作流" class="headerlink" title="动态化工作流"></a>动态化工作流</h2><blockquote>
<p>  你将需要更大的船。</p>
<p>  – 电影《大白鲨》</p>
</blockquote>
<p>除了参数化的工作流之外，经常遇到工作流内部有task的逻辑需要被重复运行几次的场景。假设task A需要从数据库查询所有的新客户列表。从这儿开始每一个客户ID都要交给另一个task做一些处理。在Airflow中，只有一个选择，实现一个下游task B，该task B接收客户ID列表，并循环一一处理。这种方式有以下缺点：</p>
<ul>
<li>UI操作界面无法体现task内部的循环造成的动态负载，执行过程难以监控</li>
<li>如果任何一条数据记录执行失败，则整个任务失败或者被丢弃形成黑洞</li>
<li>相应的，你要自己实现考虑规模和幂等逻辑，因为如果失败中途重试，系统很难理解哪些数据已经处理过，需要重试跳过。</li>
</ul>
<p>由于这是一种常见场景，因此Prefect将其专门抽象成我们称之为task mapping的功能。task mapping是指能够运行时根据上游task的输出结果来动态生成不同数量的下游task的能力。映射尤其强大，因为你可以在映射过的任务继续映射，从而轻松创建并行管道。归纳收集结果就像将映射的task作为输入输入到非映射任务一样简单。考虑一个简单例子，生成一个list，遍历每一个item两次做+1处理，然后计算liste的item之和。</p>
<p>工作流执行包括10个确认的的Prefect task，1个是list创建，4个是两次+1映射中的每一个，还有一个求和规约。任务映射提供许多好处：</p>
<ul>
<li>映射模式容易在工作流中表达</li>
<li>每一个task都是单独实例，意味着可以独立于其他单独重试告警</li>
<li>工作流的每一个执行都动态生成不同数量的task</li>
<li>作为一等公民功能，UI操作界面也能准确展示报告映射任务</li>
</ul>
<h2 id="多版本工作流"><a href="#多版本工作流" class="headerlink" title="多版本工作流"></a>多版本工作流</h2><blockquote>
<p>  为了通过编码解决工作问题，这还不够。</p>
<p>  – 《代码整洁之道》的作者[美]Robert C. Martin</p>
</blockquote>
<p>基于代码的系统的一个重要能力是能够对代码进行版本控制。</p>
<p>回想一下在Airflow里面，DAG是中枢调度器在检测指定的DAG目录包含的Python文件，并执行代码文件来发现DAG定义。这意味着，如果你更新给定的DAG，Airflow将会重新加载盲目执行，而并不会感知到代码的部分改变。如果你的DAG定义代码定期更新，这会引起一些麻烦。</p>
<ul>
<li>能够重新访问甚至运行旧的DAG的能力要求你存储旧的版本，并且还需要你在Airflow生态系统中抽象出单独的实体</li>
<li>UI操作界面对版本系统一无所知，也无法为多版本工作流提供有效的信息。</li>
</ul>
<p>在实践中，这意味着团队倾向使用GitHub控制版本，并将版本信息附加到文件名中。再者如果你的工作流代码变化缓慢，也不算负担。但是，由于数据工程日益成为快节奏的科学，包括实验和频繁更新，仅仅部署新的模型和参数，这种方式很快会失败。</p>
<p>在Prefect Cloud中，我们已经版本化的工作提升为一等公民。任何工作流都是版本集的一部分，以轻松追踪维护历史记录。与往常一样，我们有合理的默认值。</p>
<ul>
<li>当在一个项目部署一个同名工作流，版本系统会自动记录追踪</li>
<li>当一个工作流被版本化，会获得递增的版本号，并且对之前的老版本关闭自动调度和进行存档。</li>
</ul>
<p>如果你有更复杂的版本需求，这些都是有配置，可自定义的。例如，绕开项目和工作流名称规则，你可以直接指定某一个工作流是另外一个工作流的不同版本。你可以覆盖自动版本升级，来取消存档并启用旧版本（例如，用于A/B测试）。或者，你只是简单使用版本系统来维护工作流历史，而不会污染UI操作界面。</p>
<h2 id="本地测试"><a href="#本地测试" class="headerlink" title="本地测试"></a>本地测试</h2><blockquote>
<p>  可能出错的事物和不可能出错的事物之间最大的区别是，<br>  当不可能出错的事物出错时，<br>  通常发现根本无法修理。</p>
<p>  – 《Mostly Harmless》</p>
</blockquote>
<p>因为Airflow和Prefect都是用Python编写的，因此可以按照标准的Python模式来对独立的task逻辑进行单元测试。例如，在Airflow中，您可以导入DagBag提取单个DAG并对其结构或其中包含的任务进行各种声明。同样，在Prefect中，你可以轻松导入和检查工作流。此外，在Airflow和Prefect中，对于独立的task逻辑，都可以像其他Python代码一样进行单元测试。</p>
<p>然而，在Airflow中测试工作流要比Prefect复杂的多。这是由于多种原因：</p>
<ul>
<li>Airflow中的DAG级别执行是由中央调度器来控制协调的。这意味模拟数据来执行DAG需要初始化准备数据和调度服务。将其纳入CI持续集成流程中测试对很多人来说都是障碍。</li>
<li>Airflow的状态概念是用字符串描述的，这增加了测试数据传递的复杂性，或者引发什么类型异常，这需要数据库查询确定。</li>
</ul>
<p>另一方面，在Prefect中，工作流可以通过FlowRunner直接本地执行。此外，每个接口都提供了大量的额外参数，专门用于帮助测试流程，还贴心的包括一种手动指定上游task任意状态的方法。</p>
<p>例如，要确保触发器逻辑适用于单个任务，你能通过task_states关键字参数传递所有的上游任务状态，因为Prefect返回信息组合完整的状态对象（包括数据、异常和重试次数等信息），你可以轻松针对任务返回状态的性质做断言。</p>
<h2 id="UI操作界面"><a href="#UI操作界面" class="headerlink" title="UI操作界面"></a>UI操作界面</h2><blockquote>
<p>  我选择相信。</p>
<p>  – 电影《X档案》Fox Mulder</p>
</blockquote>
<p>Airflow最受欢迎的是他的web界面。在UI操作界面上，你可以轻松打开关闭DAG工作流，可视化DAG工作流执行进度，甚至可以对Airflow数据库进行查询。这是访问Airflow元数据的一种非常有用的方法。</p>
<p>这从设计Prefect的第一天开始，她就支持漂亮的实时的UI操作界面，Prefect并未参照Airflow那样直接裸露数据库数据模型，而是用最佳实践来回应用户使用过程最关心的问题：系统运行状况如何？并且如果出现问题，我如何快速定位？</p>
<p>Prefect UI操作界面支持如下：</p>
<ul>
<li>系统概况的仪表版</li>
<li>调度新的输入参数执行</li>
<li>实时更新task和对应的运行状态</li>
<li>人工干预更新状态</li>
<li>流式日志，包括立即跳转最新错误日志的能力</li>
<li>完整的交互式的GraphQL API接口</li>
<li>全局搜索</li>
<li>代理控制</li>
<li>组织工作流项目</li>
<li>团队管理和权限</li>
<li>API访问Token生成</li>
<li>密码管理</li>
<li>全局并发限制</li>
<li>时区（适合Airflow用户）</li>
<li>……还有很多</li>
</ul>
<p>UI操作界面是Prefect Cloud的一部分，它以能提供生产级工作流管理的基础结构来支持作为支持。但是我们致力于从开源产品的Cloud免费套餐开始，逐渐将完整地其提供给用户。我们正在研究将元素通过UI操作界面交付给开源用户的其他方式。</p>
<h2 id="Prefect的简单安装使用"><a href="#Prefect的简单安装使用" class="headerlink" title="Prefect的简单安装使用"></a>Prefect的简单安装使用</h2><p>安装</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install prefect</span><br></pre></td></tr></table></figure>

<p>task编写</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> prefect <span class="keyword">import</span> task, Flow, Parameter</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@task(log_stdout=True)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">say_hello</span><span class="params">(name)</span>:</span></span><br><span class="line">    print(<span class="string">"Hello, &#123;&#125;!"</span>.format(name))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> Flow(<span class="string">"My First Flow"</span>) <span class="keyword">as</span> flow:</span><br><span class="line">    name = Parameter(<span class="string">'name'</span>)</span><br><span class="line">    say_hello(name)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flow.run(name=<span class="string">'world'</span>) <span class="comment"># "Hello, world!"</span></span><br><span class="line">flow.run(name=<span class="string">'Marvin'</span>) <span class="comment"># "Hello, Marvin!"</span></span><br></pre></td></tr></table></figure>

<p>管理server启动</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">prefect server start</span><br></pre></td></tr></table></figure>

<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><blockquote>
<p>  如果我比其他人看的更远，是因为我站在巨人的肩上。</p>
<p>  – 艾萨克·牛顿</p>
</blockquote>
<p>Airflow普及了很多今天工程师认为理所当然的抽象概念和语义。不幸的是，随着数据科学工程的发展，它无法满足公司更多的动态需求。</p>
<p>Prefect是一种工具，它数以百计的工业用户那里收集了很多变化的需求。它是一个引擎，用于启用任意专有的工作流，从而提供适用各种数据应用程序的词汇表。</p>
<p>如果你想了解更多信息，请查看我们的文档或访问我们的<a href="https://github.com/PrefectHQ/prefect.git" target="_blank" rel="noopener">源码仓库</a>。如果你想试用Prefect Cloud，可以注册一个免费账号。</p>
<ul>
<li><a href="https://medium.com/the-prefect-blog/why-not-airflow-4cfa423299c4" target="_blank" rel="noopener">英版原文</a></li>
</ul>

      
    </div>
    
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/2018/08/04/goplugin/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">golang插件化方案</div>
      <strong class="article-nav-caption">></strong>
    </a>
  
</nav>

  
</article>


<div class="share_jia">
	<!-- JiaThis Button BEGIN -->
	<div class="jiathis_style">
		<span class="jiathis_txt">Share to: &nbsp; </span>
		<a class="jiathis_button_facebook"></a> 
    <a class="jiathis_button_twitter"></a>
    <a class="jiathis_button_plus"></a> 
    <a class="jiathis_button_tsina"></a>
		<a class="jiathis_button_cqq"></a>
		<a class="jiathis_button_douban"></a>
		<a class="jiathis_button_weixin"></a>
		<a class="jiathis_button_tumblr"></a>
    <a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jtico jtico_jiathis" target="_blank"></a>
	</div>
	<script type="text/javascript" src="http://v3.jiathis.com/code/jia.js?uid=1405949716054953" charset="utf-8"></script>
	<!-- JiaThis Button END -->
</div>




<div class="share_addthis">
  <div class="sharing addthis_toolbox share">
    <a class="addthis_button_facebook_like"></a>
    <a class="addthis_button_tweet"></a>
    <a class="addthis_button_google_plusone" g:plusone:size="medium"></a>
    <a class="addthis_counter addthis_pill_style"></a>
  </div>
  <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-560c64c35486b3d4" async="async"></script>
</div>




<div class="duoshuo">
	<!-- 多说评论框 start -->
	<div class="ds-thread" data-thread-key="airflow2" data-title="【译】Airflow的挑战者Prefect" data-url="http://yoursite.com/2020/04/12/airflow2/"></div>
	<!-- 多说评论框 end -->
	<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
	<script type="text/javascript">
	var duoshuoQuery = {short_name:"fangjueci"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] 
		 || document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script>
	<!-- 多说公共JS代码 end -->
</div>



</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2020 listen
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
    <script type="text/javascript">
      (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
      (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
      e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
      })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');
      
      _st('install','hPJFSMYvMX8XnCRm-L2e','2.0.0');
    </script>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
<script src="/js/main.js"></script>






<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  </div>
</body>
</html>